#!/usr/bin/env node

require('dotenv').config();

var MongoClient = require('mongodb').MongoClient;
var debug = require('debug')('monitor-app');
var MonitorApp = require('../app').MonitorApp;

MongoClient.connect(process.env.MONGO_URL, { useNewUrlParser: true })
  .then((client) => {
    let db = client.db();
    let app = MonitorApp({db});
    app.set('port', process.env.PORT || 3000);
    let server = app.listen(app.get('port'), function() {
      debug('Express server listening on port ' + server.address().port);
    });
  });
